<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1020" />
  <title>ÙØ¶Ø§ÙŠØ­ Ø±Ù…Ø¶Ø§Ù† ğŸ‘€</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#101b3b;
      --card:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.12);
      --text:#f6f7ff;
      --muted:rgba(255,255,255,.75);
      --gold:#d7b35a;
      --green:#24c26a;
      --red:#ff3b3b;
      --pink:#ff7ac8;
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius: 22px;
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: "Cairo", system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: radial-gradient(1200px 800px at 20% 0%, var(--bg2), var(--bg1));
      color:var(--text);
      overflow:hidden;
    }

    .bg{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
    }
    .bg::before{
      content:"";
      position:absolute; inset:-40px;
      background:
        radial-gradient(900px 500px at 70% 10%, rgba(215,179,90,.14), transparent 60%),
        radial-gradient(600px 420px at 10% 70%, rgba(108,180,255,.10), transparent 60%);
      opacity:.9;
    }

    .emoji-layer{ position:absolute; inset:0; opacity:.9; will-change: transform; }
    .emoji{
      position:absolute;
      font-size: clamp(18px, 5vw, 30px);
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.25));
      opacity:.85;
      transform: translate3d(0,0,0);
      will-change: transform, opacity;
      animation: floatY linear infinite;
    }
    @keyframes floatY{
      0%   { transform: translate3d(0, 24px, 0) rotate(-2deg); opacity:.65; }
      50%  { transform: translate3d(0,-28px, 0) rotate( 2deg); opacity:1; }
      100% { transform: translate3d(0, 24px, 0) rotate(-2deg); opacity:.65; }
    }

    .wrap{
      position:relative;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .card{
      width:min(520px, 100%);
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 18px;
      transform: translate3d(0,0,0);
      will-change: transform, opacity;
      position:relative;
      overflow:hidden;
    }
    .card::after{
      content:"";
      position:absolute; inset:-1px;
      background: radial-gradient(600px 200px at 50% -10%, rgba(255,255,255,.10), transparent 60%);
      pointer-events:none;
    }

    .title{
      text-align:center;
      font-weight:900;
      letter-spacing:.5px;
      margin: 0 0 6px;
      font-size: clamp(26px, 6vw, 40px);
      color: var(--gold);
      text-shadow: 0 10px 30px rgba(215,179,90,.18);
      animation: titleFloat 3.6s ease-in-out infinite;
      will-change: transform;
    }
    @keyframes titleFloat{
      0%,100%{ transform: translate3d(0, 6px, 0); }
      50%{ transform: translate3d(0,-8px, 0); }
    }
    .sub{
      text-align:center;
      color:var(--muted);
      margin:0 0 14px;
      font-size: 14px;
    }

    .center{
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      justify-content:center;
      min-height: 220px;
    }

    .typing{
      width:100%;
      min-height: 120px;
      padding: 12px 14px;
      border-radius: 18px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.10);
      line-height:1.9;
      font-size: 18px;
      color: rgba(255,255,255,.95);
      text-align:center;
    }

    .btn{
      width:100%;
      border:0;
      border-radius: 18px;
      padding: 14px 14px;
      font-weight:800;
      font-size: 18px;
      cursor:pointer;
      background: rgba(255,255,255,.10);
      color: var(--text);
      border:1px solid rgba(255,255,255,.14);
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      will-change: transform;
    }
    .btn:active{ transform: scale(.98); }
    .btn:hover{ background: rgba(255,255,255,.14); }

    .btnRow{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      width:100%;
    }
    .btnGreen{ background: rgba(36,194,106,.18); border-color: rgba(36,194,106,.35); }
    .btnRed{ background: rgba(255,59,59,.18); border-color: rgba(255,59,59,.35); }
    .btnPink{ background: rgba(255,122,200,.18); border-color: rgba(255,122,200,.35); }

    .hint{
      text-align:center;
      font-size: 12px;
      color: rgba(255,255,255,.78);
      margin-top: -2px;
    }

    .music{
      position:fixed;
      right: 14px;
      bottom: 14px;
      z-index: 50;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      cursor:pointer;
      user-select:none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .arrow{
      width: 34px; height: 34px;
      border-radius: 999px;
      display:grid;
      place-items:center;
      background: rgba(215,179,90,.18);
      border: 1px solid rgba(215,179,90,.35);
      animation: bounce 1.1s ease-in-out infinite;
      will-change: transform;
    }
    @keyframes bounce{
      0%,100%{ transform: translate3d(0,0,0); }
      50%{ transform: translate3d(0,-6px,0); }
    }
    .music small{
      display:block;
      font-size: 11px;
      color: rgba(255,255,255,.80);
      line-height: 1.15;
      text-align:right;
    }
    .music strong{
      display:block;
      font-size: 13px;
      color: #fff;
    }

    body.theme-ramadan{
      background: radial-gradient(1200px 800px at 20% 0%, #152a5a, #0b1020);
    }
    body.theme-calm{
      background: radial-gradient(1200px 800px at 30% 10%, #ffe1f2, #ff9fd6);
      color:#1b1020;
    }
    body.theme-calm .card{
      background: rgba(255,255,255,.58);
      border-color: rgba(0,0,0,.08);
      color:#1b1020;
    }
    body.theme-calm .typing{
      background: rgba(255,255,255,.65);
      border-color: rgba(0,0,0,.08);
      color:#1b1020;
    }
    body.theme-calm .btn{
      background: rgba(255,255,255,.70);
      border-color: rgba(0,0,0,.10);
      color:#1b1020;
    }
    body.theme-calm .sub, body.theme-calm .hint{ color: rgba(0,0,0,.70); }

    body.theme-horror{
      background: radial-gradient(1200px 800px at 40% 0%, #3b0a0a, #140000);
    }
    body.theme-horror .card::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(20px 20px at 10% 20%, rgba(0,0,0,.35), transparent 60%),
        radial-gradient(30px 30px at 80% 60%, rgba(0,0,0,.35), transparent 60%),
        radial-gradient(26px 26px at 40% 90%, rgba(0,0,0,.35), transparent 60%);
      opacity:.9;
      pointer-events:none;
    }

    .fadeIn{ animation: fadeIn .22s ease both; }
    @keyframes fadeIn{ from{ opacity:0; transform: translate3d(0,10px,0);} to{opacity:1; transform: translate3d(0,0,0);} }

    .toast{
      position:fixed;
      left: 50%;
      bottom: 86px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.18);
      color:#fff;
      padding: 10px 14px;
      border-radius: 999px;
      z-index: 60;
      opacity:0;
      pointer-events:none;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: opacity .18s ease, transform .18s ease;
      font-size: 13px;
      max-width: 92vw;
      text-align:center;
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(-6px);
    }

    .xo{
      width: min(340px, 100%);
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin: 4px auto 0;
    }
    .cell{
      aspect-ratio: 1/1;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      display:grid;
      place-items:center;
      font-size: 42px;
      font-weight: 900;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, background .12s ease;
      will-change: transform;
    }
    .cell:active{ transform: scale(.98); }

    .lockBox{
      position:relative;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      min-height: 220px;
    }
    .lockBox img{
      width:100%;
      height:auto;
      display:block;
      filter: blur(14px) saturate(.9);
      transform: scale(1.02);
      transition: filter .35s ease, transform .35s ease;
    }
    .lockOverlay{
      position:absolute; inset:0;
      display:grid;
      place-items:center;
      gap:10px;
      text-align:center;
      padding: 14px;
      background: linear-gradient(to bottom, rgba(0,0,0,.20), rgba(0,0,0,.45));
    }
    .lockIcon{
      font-size: 40px;
      filter: drop-shadow(0 12px 20px rgba(0,0,0,.35));
      animation: lockPulse 1.1s ease-in-out infinite;
    }
    @keyframes lockPulse{
      0%,100%{ transform: scale(1); }
      50%{ transform: scale(1.07); }
    }
    .unlocked img{ filter: blur(0px) saturate(1.05); transform: scale(1); }
    .unlocked .lockOverlay{
      opacity:0;
      pointer-events:none;
      transition: opacity .2s ease;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .thumb{
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      cursor:pointer;
    }
    .thumb img{
      width:100%; height: 170px;
      object-fit: cover;
      display:block;
      transform: translate3d(0,0,0);
      transition: transform .18s ease;
    }
    .thumb:active img{ transform: scale(1.02); }

    .modal{
      position:fixed; inset:0;
      background: rgba(0,0,0,.70);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 80;
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);
    }
    .modal.show{ display:flex; }
    .modalInner{
      width:min(560px, 100%);
      border-radius: 22px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.25);
      position:relative;
    }
    .modalInner img{
      width:100%; height:auto;
      display:block;
    }
    .close{
      position:absolute;
      top: 10px; left: 10px;
      border:0;
      border-radius: 999px;
      width: 40px; height: 40px;
      background: rgba(0,0,0,.45);
      border: 1px solid rgba(255,255,255,.18);
      color:#fff;
      font-size: 20px;
      cursor:pointer;
    }

    .footer{
      margin-top: 12px;
      text-align:center;
      font-size: 12px;
      color: rgba(255,255,255,.72);
    }
    body.theme-calm .footer{ color: rgba(0,0,0,.65); }

    @media (prefers-reduced-motion: reduce){
      .emoji, .title, .arrow, .lockIcon{ animation: none !important; }
      .fadeIn{ animation: none !important; }
    }
  </style>
</head>

<body class="theme-ramadan">
  <div class="bg">
    <div class="emoji-layer" id="emojiLayer"></div>
  </div>

  <div class="wrap">
    <div class="card fadeIn" id="app"></div>
  </div>

  <div class="music" id="musicBtn" role="button" aria-label="Music toggle">
    <div class="arrow">â¬‡ï¸</div>
    <div>
      <strong>ğŸµ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰</strong>
      <small>Ø§Ù‚ÙÙ„ Ø§Ù„Ø§ØºÙ†ÙŠÙ‡</small>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <div class="modal" id="modal">
    <div class="modalInner">
      <button class="close" id="closeModal">âœ•</button>
      <img id="modalImg" alt="preview" />
    </div>
  </div>

<script>
(() => {
  // ========= Ø§Ù„ØµÙˆØ± =========
  const IMAGES = {
    1: "assets/img/1.jpg",
    2: "assets/img/2.jpg",
    3: "assets/img/3.jpg",
    4: "assets/img/4.jpg",
    5: "assets/img/5.jpg",
    6: "assets/img/6.jpg",
    7: "assets/img/7.jpg",
  };
  const GALLERY_ORDER = [1,2,3,4,5,6,7];

  // ========= Ø§Ù„ØµÙˆØª =========
  const audioRamadan = new Audio("assets/audio/ramadan.mp3");
  const audioTense   = new Audio("assets/audio/tense.mp3");
  audioRamadan.loop = true;
  audioTense.loop = true;
  audioRamadan.preload = "auto";
  audioTense.preload = "auto";

  let musicOn = true;
  let userInteracted = false;

  const app = document.getElementById("app");
  const toast = document.getElementById("toast");
  const emojiLayer = document.getElementById("emojiLayer");

  const modal = document.getElementById("modal");
  const modalImg = document.getElementById("modalImg");
  document.getElementById("closeModal").addEventListener("click", () => modal.classList.remove("show"));
  modal.addEventListener("click", (e) => { if(e.target === modal) modal.classList.remove("show"); });

  const sleep = (ms) => new Promise(r => setTimeout(r, ms));
// Ø³Ø±Ø¹Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© + Ù…Ø¯Ø© Ø¨Ù‚Ø§Ø¡ Ø§Ù„ÙƒÙ„Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©
const INTRO_CHAR_MS  = 45;   // ÙƒÙ„ Ø­Ø±Ù ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ø£Ø¨Ø·Ø£)
const INTRO_PAUSE_MS = 1800; // Ø¨Ø¹Ø¯ ÙƒÙ„ Ø¬Ù…Ù„Ø© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (ÙŠØ·ÙˆÙ„)
const FINAL_CHAR_MS  = 32;   // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ© (Ø£Ø¨Ø·Ø£)
const TOAST_DEFAULT_MS = 1700; // Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù„ÙŠ Ø¨ØªØ¸Ù‡Ø± ØªØ­Øª (ÙŠØ·ÙˆÙ„)

 function showToast(msg, ms=TOAST_DEFAULT_MS){
    toast.textContent = msg;
    toast.classList.add("show");
    clearTimeout(showToast._t);
    showToast._t = setTimeout(() => toast.classList.remove("show"), ms);
  }

  function stopAll(){
    audioRamadan.pause();
    audioTense.pause();
  }

  function playRamadan(){
    stopAll();
    if(!musicOn || !userInteracted) return;
    const p = audioRamadan.play();
    if(p && typeof p.catch === "function"){
      p.catch(() => showToast("Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ØªØ­Øª ÙŠÙ…ÙŠÙ† Ù„ØªØ´ØºÙŠÙ„Ù‡Ø§ ğŸµ", 1400));
    }
  }

  function playTense(){
    stopAll();
    if(!musicOn || !userInteracted) return;
    const p = audioTense.play();
    if(p && typeof p.catch === "function"){
      p.catch(() => showToast("Ø§Ø¶ØºØ· Ø²Ø± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ØªØ­Øª ÙŠÙ…ÙŠÙ† Ù„ØªØ´ØºÙŠÙ„Ù‡Ø§ ğŸµ", 1400));
    }
  }

  function setTheme(theme){
    document.body.classList.remove("theme-ramadan","theme-calm","theme-horror");
    document.body.classList.add(`theme-${theme}`);
    setBgMode(theme);

    if(theme === "horror") playTense();
    else playRamadan();
  }

  // ========= Ø²Ø± Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ =========
  document.getElementById("musicBtn").addEventListener("click", () => {
    userInteracted = true;
    musicOn = !musicOn;
    if(musicOn){
      showToast("Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ø´ØºÙ‘Ø§Ù„Ø© ğŸ¶", 900);
      if(document.body.classList.contains("theme-horror")) playTense();
      else playRamadan();
    }else{
      stopAll();
      showToast("ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ âœ…", 900);
    }
  });

  // ========= Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠØ² =========
  let bgMode = "ramadan";
  function setBgMode(mode){
    bgMode = mode;
    buildEmojis();
  }

  function buildEmojis(){
    emojiLayer.innerHTML = "";
    const sets = {
      ramadan: ["ğŸŒ™","â˜ªï¸","âœ¨","ğŸ•Œ","ğŸŒŸ","ğŸ¤"],
      calm:    ["ğŸŒ¸","ğŸ’—","ğŸŒ·","âœ¨","ğŸ«¶","ğŸ€"],
      horror:  ["â›”","ğŸ©¸","âš ï¸","â˜ ï¸","ğŸ•·ï¸","ğŸ–¤"]
    };
    const list = sets[bgMode] || sets.ramadan;

    const count = 14;
    for(let i=0;i<count;i++){
      const el = document.createElement("div");
      el.className = "emoji";
      el.textContent = list[Math.floor(Math.random()*list.length)];
      el.style.left = (Math.random()*100) + "%";
      el.style.top  = (Math.random()*100) + "%";
      el.style.animationDuration = (3.5 + Math.random()*4.5).toFixed(2) + "s";
      el.style.animationDelay = (-Math.random()*4).toFixed(2) + "s";
      el.style.opacity = (0.55 + Math.random()*0.45).toFixed(2);
      emojiLayer.appendChild(el);
    }
  }

  // ========= Ø±Ù†Ø¯Ø± (Ù…ØªØ¹Ø¯Ù„: ÙÙˆØ±ÙŠ Ø¹Ø´Ø§Ù† Ø§Ù„Ø§ÙŠÙÙ†ØªØ³ ØªØ´ØªØºÙ„) =========
  function render(html){
    app.classList.remove("fadeIn");
    app.innerHTML = html;
    requestAnimationFrame(() => app.classList.add("fadeIn"));
  }

  // ========= ØªØ§ÙŠØ¨ Ø±Ø§ÙŠØªØ± =========
  async function typewriter(el, text, speed=26){
    el.textContent = "";
    for(let i=0;i<text.length;i++){
      el.textContent += text[i];
      await sleep(speed);
    }
  }

  // ========= Ø²Ø±Ø§Ø± Ø¨ÙŠÙ‡Ø±Ø¨ =========
  function makeEscape(btn, container, opts={}){
    const { maxMoves = Infinity, onFinal = null, toastEach = null, toastMsg = null } = opts;
    let moves = 0;

    const move = () => {
      moves++;
      if(toastEach) showToast(toastEach, 900);

      const rect = container.getBoundingClientRect();
      const b = btn.getBoundingClientRect();
      const pad = 10;

      const maxX = Math.max(pad, rect.width  - b.width  - pad);
      const maxY = Math.max(pad, rect.height - b.height - pad);

      const x = pad + Math.random() * (maxX - pad);
      const y = pad + Math.random() * (maxY - pad);

      btn.style.position = "absolute";
      btn.style.left = x + "px";
      btn.style.top  = y + "px";
      btn.style.transition = "left .18s ease, top .18s ease";
    };

    const onDown = (e) => {
      e.preventDefault();
      e.stopPropagation();

      if(moves < maxMoves){
        move();
      }else{
        if(toastMsg) showToast(toastMsg, 1100);
        if(onFinal) onFinal();
      }
    };

    const onEnter = () => { if(moves < maxMoves) move(); };

    btn.addEventListener("pointerdown", onDown, {passive:false});
    btn.addEventListener("pointerenter", onEnter);

    btn.style.position = "relative";
    btn.style.left = "0px";
    btn.style.top  = "0px";
  }

  // ========= Ø§Ù„Ø­Ø§Ù„Ø© =========
  let branch = null; // "rasha" | "salma"

  // ========= Ø´Ø§Ø´Ø§Øª =========
  function screenLanding(){
    setTheme("ramadan");
    render(`
      <h1 class="title">Ø±Ù…Ø¶Ø§Ù†</h1>
      <p class="sub">Ø¯ÙŠØ²Ø§ÙŠÙ† Ø±Ù…Ø¶Ø§Ù†ÙŠ + Ø´ÙˆÙŠØ© Ù…ÙØ§Ø¬Ø¢Øªâ€¦ ğŸ˜ˆ</p>

      <div class="center">
        <button class="btn btnPink" id="startBtn">Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„Ø© ÙØ¶Ø§ÙŠØ­ Ø±Ù…Ø¶Ø§Ù†</button>
        <div class="hint">Ø²Ø± â€œØ§Ù‚ÙÙ„ Ø§Ù„Ø§ØºÙ†ÙŠÙ‡â€ ØªØ­Øª ÙŠÙ…ÙŠÙ† ğŸ‘‡</div>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("startBtn").addEventListener("click", async () => {
      userInteracted = true;
      if(musicOn) playRamadan();
      await introSequence();
    });
  }

  async function introSequence(){
    setTheme("ramadan");
    render(`
      <h1 class="title">Ø±Ù…Ø¶Ø§Ù†</h1>
      <p class="sub">Ø±ÙƒØ²â€¦ Ø§Ù„ÙƒÙ„Ø§Ù… Ù‡ÙŠØ¸Ù‡Ø± â€œÙƒØªØ§Ø¨Ø©â€</p>
      <div class="center">
        <div class="typing" id="typeBox"></div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const box = document.getElementById("typeBox");
    await typewriter(box, "Ø§Ù†Ø§ Ù…ØµØ·ÙÙ‰ Ø­Ø¨ÙŠØª Ø§Ù‚ÙˆÙ„ÙƒÙ… Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… Ø¨ Ø·Ø±ÙŠÙ‚Ù‡ Ù…Ø®ØªÙ„ÙÙ‡ .", 24);
    await sleep(950);
    box.textContent = "";
    await typewriter(box, "Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… Ø¹Ù„ÙŠÙƒÙ… Ùˆ ÙŠÙ†Ø¹Ø§Ø¯ Ø¹Ù„ÙŠÙƒÙ… Ø¨ Ø§Ù„Ø®ÙŠØ± Ùˆ Ø§Ù„Ø³Ø¹Ø§Ø¯Ù‡ ÙŠØ§Ø±Ø¨ ..", 24);
    await sleep(950);
    box.textContent = "";
    await typewriter(box, "ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ®ØªØ§Ø± Ø§Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨ØªØ§Ø¹Ù‡ Ø¹Ø´Ø§Ù† Ù…Ø­Ø¯Ø´ ÙŠØ¯Ø®Ù„ Ø¹Ù„Ù‰ ÙØ¶Ø§ÙŠØ­ Ø§Ù„ØªØ§Ù†ÙŠğŸ’¿ .", 24);
    await sleep(950);
    box.textContent = "";
    await typewriter(box, "good luck ğŸ˜ˆ", 34);
    await sleep(950);

    screenHorrorChoice1();
  }

  function screenHorrorChoice1(){
    setTheme("horror");
    render(`
      <div class="center" style="min-height:260px">
        <div class="typing" style="font-weight:900">â€¦</div>
        <div class="btnRow" id="hRow" style="position:relative; min-height:120px;">
          <button class="btn btnGreen" id="goBtn">Ø§Ø³ØªÙ…Ø±</button>
          <button class="btn btnRed" id="scaredBtn">Ù„Ø§ ÙŠØ¹Ù… Ø§Ù†Ø§ Ø®Ø§ÙŠÙ</button>
        </div>
        <div class="hint">ğŸ˜ˆ</div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const row = document.getElementById("hRow");
    const go = document.getElementById("goBtn");
    const scared = document.getElementById("scaredBtn");

    makeEscape(go, row, { toastEach: "Ù„Ø§ Ù„Ø§ Ù„Ø§â€¦ ğŸ˜…" });
    scared.addEventListener("click", () => screenCalmNoFear());
  }

  function screenCalmNoFear(){
    setTheme("calm");
    render(`
      <h2 class="title" style="color:#1b1020; text-shadow:none">ğŸŒ¸</h2>
      <div class="center">
        <div class="typing" style="font-weight:900; font-size:20px;">Ø·Ø¨ Ùˆ ÙƒØ¯Ù‡ØŸ</div>
        <div class="btnRow">
          <button class="btn btnGreen" id="ok1">Ø®Ù„Ø§Øµ Ù‡Ø³ØªÙ…Ø±</button>
          <button class="btn btnRed" id="ok2">Ù‡Ø³ØªÙ…Ø± Ø¨Ø±Ø¯Ùˆ</button>
        </div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("ok1").addEventListener("click", screenSeatSelect);
    document.getElementById("ok2").addEventListener("click", screenSeatSelect);
  }

  function screenSeatSelect(){
    setTheme("calm");
    render(`
      <div class="center">
        <div class="hint" style="font-weight:900">âš ï¸ ÙƒÙ„ ÙˆØ§Ø­Ø¯ ÙŠØ®ØªØ§Ø± Ù…ÙƒØ§Ù†Ù‡ ÙƒÙˆÙŠØ³.</div>
        <button class="btn btnPink" id="rasha">Ø®Ø§Ù„ØªÙˆ Ø±Ø§Ø´Ø§</button>
        <button class="btn btnPink" id="salma">Ø®Ø§Ù„ØªÙˆ Ø³Ù„Ù…Ù‰</button>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("rasha").addEventListener("click", () => screenConfirm("rasha"));
    document.getElementById("salma").addEventListener("click", () => screenConfirm("salma"));
  }

  function screenConfirm(choice){
    setTheme("horror");
    render(`
      <div class="center">
        <div class="typing" style="font-weight:900">Ù‡Ù„ Ø§Ù†Øª ÙØ¹Ù„Ø§ Ø§Ø®ØªØ±Øª Ù…ÙƒØ§Ù†Ùƒ ÙˆÙ„Ø§ Ø¨ØªØ¬Ø±Ø¨ØŸ</div>
        <div class="btnRow">
          <button class="btn btnGreen" id="sure">Ø§ÙŠÙˆØ§ Ù…ØªØ£ÙƒØ¯..</button>
          <button class="btn btnRed" id="sorry">Ù„Ø§ ÙŠØ¹Ù… Ø§Ù†Ø§ Ø§Ø³Ù</button>
        </div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("sorry").addEventListener("click", async () => {
      showToast("Ù…Ù†Øª Ø¹Ø§Ø±Ù Ø§Ù† Ø­Ø¯ Ù‡Ø§ÙŠØºØ´ .", 1200);
      await sleep(650);
      screenSeatSelect();
    });

    document.getElementById("sure").addEventListener("click", () => {
      branch = choice;
      screenBranchIntro();
    });
  }

  function screenBranchIntro(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ…</h2>
      <div class="center">
        <div class="typing" style="font-weight:900">Ù‡Ø§ØªÙŠ Ø§Ù„Ø¹ÙŠØ§Ù„ ÙˆØ§Ù‚Ø¹Ø¯ÙˆØ§ Ø§ØªÙØ±Ø¬ÙˆØ§ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¶Ø§ÙŠØ­ .</div>
        <div class="btnRow">
          <button class="btn btnPink" id="c1">ÙƒÙ…Ù„</button>
          <button class="btn btnPink" id="c2">ÙƒÙ…Ù„</button>
        </div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("c1").addEventListener("click", screenQuranQuiz);
    document.getElementById("c2").addEventListener("click", screenQuranQuiz);
  }

  function screenQuranQuiz(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ø³Ø¤Ø§Ù„ Ø³Ø±ÙŠØ¹</h2>
      <p class="sub">Ø¬Ø§ÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¹Ø´Ø§Ù† ØªÙƒÙ…Ù„</p>
      <div class="center">
        <div class="typing" style="font-weight:900">Ø§Ù„Ù‚Ø±Ø£Ù† ÙÙŠÙ‡ ÙƒØ§Ù… Ø¬Ø²Ø¡ØŸ</div>
        <div class="btnRow">
          <button class="btn btnGreen" id="a30">30 Ø¬Ø²Ø¡</button>
          <button class="btn btnRed" id="a60">60 Ø¬Ø²Ø¡</button>
        </div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("a60").addEventListener("click", async () => {
      showToast("âŒ Ø§Ø²Ø§ÙŠ Ù…Ø­Ø¯Ø´ ÙŠØ¹Ø±Ù Ø§Ù„Ø§Ø¬Ø§Ø¨Ù‡ Ø¯ÙŠ .", 1300);
      await sleep(650);
      screenQuranQuiz();
    });

    document.getElementById("a30").addEventListener("click", screenLock1);
  }

  function revealMap(){
    if(branch === "salma") return { first: 2, second: 1 };
    return { first: 4, second: 2 };
  }

  function screenLock1(){
    setTheme("ramadan");
    const { first } = revealMap();
    render(`
      <h2 class="title">Ù‚ÙÙ„ ğŸ”’</h2>
      <p class="sub">Ø­Ù„ Ø§Ù„Ù„ØºØ² Ø§Ù„ÙŠ Ø¬Ø§ÙŠ Ø¹Ø´Ø§Ù† ØªÙØªØ­ Ø§ÙˆÙ„ ÙØ¶ÙŠØ­Ù‡</p>

      <div class="center">
        <div class="lockBox">
          <img src="${IMAGES[first]}" alt="locked" />
          <div class="lockOverlay">
            <div class="lockIcon">ğŸ”’</div>
            <div style="font-weight:900">Ø§Ù„ØµÙˆØ±Ø© Ù…Ù‚ÙÙˆÙ„Ø©</div>
          </div>
        </div>

        <button class="btn btnPink" id="goXO">ØªÙ…Ø§Ù…</button>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("goXO").addEventListener("click", screenXO);
  }

  // ========= XO =========
  let board = Array(9).fill("");
  function checkWin(b){
    const wins = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];
    for(const [a,c,d] of wins){
      if(b[a] && b[a]===b[c] && b[a]===b[d]) return b[a];
    }
    if(b.every(x => x)) return "draw";
    return null;
  }
  function computerMove(){
    const empty = board.map((v,i)=>v?null:i).filter(v=>v!==null);
    let pick = empty[Math.floor(Math.random()*empty.length)];
    if(Math.random() < 0.30){
      for(const i of empty){
        const test = board.slice();
        test[i] = "X";
        if(checkWin(test) === "X"){ pick = i; break; }
      }
    }
    board[pick] = "O";
  }

  function screenXO(){
    setTheme("ramadan");
    board = Array(9).fill("");

    render(`
      <h2 class="title">Ù„Ø¹Ø¨Ø© XO</h2>
      <p class="sub">Ø§ÙƒØ³Ø¨ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± Ø¹Ø´Ø§Ù† Ø§Ù„Ù‚ÙÙ„ ÙŠØªÙØªØ­ (Ø³Ù‡Ù„ Ø¬Ø¯Ù‹Ø§)</p>

      <div class="center">
        <div class="xo" id="xo"></div>
        <button class="btn" id="resetXO">Ø¥Ø¹Ø§Ø¯Ø©</button>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const xo = document.getElementById("xo");
    document.getElementById("resetXO").addEventListener("click", screenXO);

    function draw(){
      xo.innerHTML = "";
      board.forEach((v,i)=>{
        const cell = document.createElement("div");
        cell.className = "cell";
        cell.textContent = v;
        cell.addEventListener("click", async () => {
          if(board[i]) return;

          board[i] = "X";
          cell.textContent = "X";

          let res = checkWin(board);
          if(res){ await endXO(res); return; }

          await sleep(160);
          computerMove();
          draw();

          res = checkWin(board);
          if(res) await endXO(res);
        });
        xo.appendChild(cell);
      });
    }

    async function endXO(res){
      if(res === "X"){
        showToast("âœ… ÙƒØ³Ø¨Øª! Ø§Ù„Ù‚ÙÙ„ Ù‡ÙŠØªÙØªØ­â€¦", 1200);
        await sleep(650);
        screenReveal1();
      } else if(res === "O"){
        showToast("âŒ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ØºØ´Ùƒ ğŸ˜­ Ø¬Ø±Ù‘Ø¨ ØªØ§Ù†ÙŠ", 1200);
      } else {
        showToast("ØªØ¹Ø§Ø¯Ù„â€¦ Ø¬Ø±Ù‘Ø¨ ØªØ§Ù†ÙŠ", 1100);
      }
    }

    draw();
  }

  function screenReveal1(){
    setTheme("ramadan");
    const { first } = revealMap();
    render(`
      <h2 class="title">Ø§ØªÙØªØ­ ğŸ”“</h2>
      <p class="sub">Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª</p>

      <div class="center">
        <div class="lockBox unlocked">
          <img src="${IMAGES[first]}" alt="reveal1" />
          <div class="lockOverlay"><div class="lockIcon">ğŸ”“</div></div>
        </div>

        <button class="btn btnPink" id="next1">Ø§Ø³ØªÙ…Ø±Ø§Ø±</button>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("next1").addEventListener("click", screenPreMath);
  }

  function screenPreMath(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ø§Ù„ÙØ¶ÙŠØ­Ù‡ Ø§Ù„ØªØ§Ù†ÙŠÙ‡</h2>
      <div class="center">
        <div class="typing" style="font-weight:900">Ø§Ù„ÙØ¶ÙŠØ­Ù‡ Ø§Ù„ØªØ§Ù†ÙŠÙ‡ Ù‡ØªÙƒÙˆÙ† Ø³Ù‡Ù„Ø© .</div>
        <div class="btnRow">
          <button class="btn btnGreen" id="goMath1">Ø§Ø³ØªÙ…Ø±</button>
          <button class="btn btnRed" id="goMath2">Ù„Ø§ ÙŠØ¹Ù… Ø§Ù†Øª ÙØ§Ø¶ÙŠ Ø¨Ù‚Ø§ .</button>
        </div>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("goMath1").addEventListener("click", screenMath);
    document.getElementById("goMath2").addEventListener("click", screenMath);
  }

  function screenMath(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ù…Ø¹Ø§Ø¯Ù„Ø©</h2>
      <p class="sub">4 * 3 + 5 = ØŸ</p>
      <div class="center">
        <div class="btn" style="cursor:default">Ø§Ø®ØªØ§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div>
        <button class="btn" id="m20">20</button>
        <button class="btn" id="m15">15</button>
        <button class="btn btnGreen" id="m17">17</button>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const wrong = async () => {
      showToast("âŒ Ø®Ù„ÙŠ Ø¨Ø§Ù„ÙƒÙ… Ø§Ù†Ø§ Ø¹Ø§Ù…Ù„ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø¬Ø¯Ø¹Ù†Ù‡ .", 1500);
      await sleep(650);
      screenMath();
    };
    document.getElementById("m20").addEventListener("click", wrong);
    document.getElementById("m15").addEventListener("click", wrong);
    document.getElementById("m17").addEventListener("click", screenReveal2);
  }

  function screenReveal2(){
    setTheme("ramadan");
    const { second } = revealMap();
    render(`
      <h2 class="title">Ø§ØªÙØªØ­ ğŸ”“</h2>
      <p class="sub">Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„Ø³ÙƒØ±ÙŠÙ† Ø´ÙˆØª</p>

      <div class="center">
        <div class="lockBox unlocked">
          <img src="${IMAGES[second]}" alt="reveal2" />
          <div class="lockOverlay"><div class="lockIcon">ğŸ”“</div></div>
        </div>

        <button class="btn btnPink" id="after2">Ø§Ø³ØªÙ…Ø±</button>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.getElementById("after2").addEventListener("click", screenNoMorePuzzles);
  }

  function screenNoMorePuzzles(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ù…Ø¨Ø±ÙˆÙƒ ğŸ‰</h2>
      <div class="center">
        <div class="typing" style="font-weight:900">
          Ù…Ø¨Ø±ÙˆÙƒ ÙƒÙ„ Ø§Ù„ÙØ¶Ø§ÙŠØ­ Ù‡ØªØªÙØªØ­Ù„Ùƒ Ù…Ù† ØºÙŠØ± Ø§Ù„ØºØ§Ø² Ø¹Ø´Ø§Ù† ØªØ¹Ø¨Øª Ø§Ù„ØµØ±Ø§Ø­Ù‡ ğŸ˜¢.
        </div>

        <div id="escapeArea" style="position:relative; width:100%; min-height:90px;">
          <button class="btn btnPink" id="escapeBtn">Ø§Ø³ØªÙ…Ø±</button>
        </div>

        <div class="hint">ÙƒÙ„ Ù…Ø±Ø©: Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ Ø´ÙƒÙ„Ù‡Ø§ Ù…Ø´ÙƒÙ„Ù‡ ØªÙ‚Ù†ÙŠÙ‡ .</div>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const area = document.getElementById("escapeArea");
    const b = document.getElementById("escapeBtn");

    makeEscape(b, area, {
      maxMoves: 4,
      toastEach: "Ø­Ø§ÙˆÙ„ ØªØ§Ù†ÙŠ Ø´ÙƒÙ„Ù‡Ø§ Ù…Ø´ÙƒÙ„Ù‡ ØªÙ‚Ù†ÙŠÙ‡ .",
      toastMsg: "Ø®Ù„Ø§Øµâ€¦ Ø§Ù„Ù…Ø±Ø© Ø¯ÙŠ âœ…",
      onFinal: () => screenGallery()
    });
  }

  function screenGallery(){
    setTheme("ramadan");
    const thumbs = GALLERY_ORDER.map(n => `
      <div class="thumb" data-src="${IMAGES[n]}">
        <img src="${IMAGES[n]}" alt="img${n}">
      </div>
    `).join("");

    render(`
      <h2 class="title">ÙƒÙ„ Ø§Ù„ØµÙˆØ± ğŸ‘€</h2>
      <p class="sub">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ ØµÙˆØ±Ø© Ø¹Ø´Ø§Ù† ØªÙƒØ¨Ø±</p>

      <div class="grid" id="grid">${thumbs}</div>

      <div class="center" style="min-height:auto; margin-top:12px;">
        <button class="btn btnPink" id="goEnd">Ø§Ø³ØªÙ…Ø±</button>
      </div>

      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    document.querySelectorAll(".thumb").forEach(t => {
      t.addEventListener("click", () => {
        modalImg.src = t.getAttribute("data-src");
        modal.classList.add("show");
      });
    });

    document.getElementById("goEnd").addEventListener("click", screenFinal);
  }

  async function screenFinal(){
    setTheme("ramadan");
    render(`
      <h2 class="title">Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</h2>
      <div class="center">
        <div class="typing" id="finalBox"></div>
        <button class="btn btnGreen" id="finalBtn">Ø§Ù„Ù†Ù‡Ø§ÙŠÙ‡</button>
      </div>
      <div class="footer">created by: Ø¨Ù†ÙŠ Ø§Ø¯Ù… Ø¨Ø±Ø§Ø³ ÙØ±Ø®Ù‡ (Ù…ØµØ·ÙÙ‰)</div>
    `);

    const box = document.getElementById("finalBox");
    await typewriter(
      box,
      "Ù…Ø¨Ø±ÙˆÙƒ Ø¯ÙŠ ÙƒØ¯Ù‡ Ø§Ù„Ù†Ù‡Ø§ÙŠÙ‡ ÙŠØ§Ø±Ø¨ Ø§ÙƒÙˆÙ† Ø±Ø³Ù…Øª Ø§Ø¨ØªØ³Ø§Ù…Ù‡ Ø¹Ù„Ù‰ ÙˆØ´ÙˆØ´ÙƒÙ… Ùˆ Ø±Ù…Ø¶Ø§Ù† ÙƒØ±ÙŠÙ… ÙˆØ§Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø±Ø¨Ù†Ø§ ÙŠÙ†Ø¬Ø­Ù†Ø§ Ø§Ù„Ø³Ù†Ø§Ø¯ÙŠ Ùˆ ÙŠÙ†Ø¬Ø­ Ø§Ù„Ù†Ø§Ø³ Ø¨ØªØ§Ø¹Øª ØªØ§Ù„ØªÙ‡ Ø§Ø¹Ø¯Ø§Ø¯ÙŠ Ùˆ ØªØ§Ù„ØªÙ‡ Ø«Ø§Ù†ÙˆÙŠ ğŸ˜„âœ…",
      22
    );

    document.getElementById("finalBtn").addEventListener("click", () => {
      window.location.href = "https://youtu.be/xtRoFhRzFAs?si=fl1n9mbtEmSBENpu";
    });
  }

  // ========= ØªØ´ØºÙŠÙ„ =========
  buildEmojis();
  screenLanding();

})();
</script>
</body>
</html>
